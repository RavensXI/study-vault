<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>StudyVault &mdash; GCSE Revision</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <!-- Hero -->
  <section class="hero">
    <h1>StudyVault<svg class="logo-lock" viewBox="0 0 2048 2048" aria-hidden="true"><path fill="currentColor" d="M 1006.55 384.5 C 1012.26 384.032 1017.96 384.019 1023.69 384.03 C 1126.34 383.508 1224.86 424.385 1296.99 497.419 C 1360.21 560.738 1398.86 644.469 1406.04 733.658 C 1408.66 765.139 1407.27 812.813 1407.19 845.206 C 1408.84 845.067 1410.49 844.96 1412.14 844.887 C 1429.72 844.275 1447.74 845.081 1465.32 844.677 C 1495.06 843.994 1535.25 840.392 1535.47 882.388 L 1535.36 1317.69 L 1535.32 1438.19 C 1535.26 1507.75 1538.75 1557.74 1484.85 1611.82 C 1460.86 1635.66 1430.61 1652.23 1397.59 1659.62 C 1375.13 1664.65 1350.12 1663.97 1327.09 1663.93 L 1262.44 1663.83 L 1039.75 1663.73 L 791.843 1663.77 C 753.977 1663.77 680.267 1666.52 646.687 1658.7 C 616.228 1651.35 588.323 1635.91 565.929 1614 C 532.163 1581.54 512.105 1536.9 512.157 1490.19 C 512.202 1449.42 512.422 1408.59 512.416 1367.82 L 512.46 1090.95 L 512.437 949.482 C 512.426 925.408 512.016 901.145 513.113 877.152 C 513.68 864.772 526.116 849.163 538.208 846.652 C 551.022 843.991 567.128 844.956 580.366 844.959 C 600.487 844.856 620.61 844.943 640.73 845.219 C 639.551 827.347 640.432 805.755 640.372 787.686 C 640.3 766.215 640.741 742.607 643.073 721.312 C 651.702 644.63 683.654 572.444 734.615 514.5 C 806.373 432.129 899.065 391.821 1006.55 384.5 z M 716.467 845.223 C 818.381 844.143 921.774 845.464 1023.95 845.099 L 1331.64 844.834 L 1331.54 843.821 C 1330.34 831.289 1331.21 811.921 1331.49 799.241 C 1331.8 783.652 1331.59 768.058 1330.86 752.483 C 1326.9 666.541 1286.96 586.231 1220.82 531.214 C 1176.33 494.282 1122.33 470.636 1065.02 462.987 C 1056.45 461.791 1035.74 459.773 1026.64 460.477 C 938.331 462.331 863.078 491.197 801.283 555.598 C 753.658 605.045 724.17 669.155 717.618 737.494 C 714.147 772.586 716.753 809.897 716.467 845.223 z"/><path class="logo-lock-keyhole" d="M 1010.92 1075.34 C 1032.39 1072.69 1058.68 1077.88 1078.25 1086.82 C 1108.74 1101.11 1132.38 1126.83 1144.05 1158.4 C 1155.23 1188.63 1153.67 1227.84 1139.51 1256.66 C 1122.21 1291.9 1098.3 1312.15 1062.02 1325.22 C 1061.91 1344.15 1065.34 1395.94 1058.79 1410.84 C 1054.1 1421.5 1045.86 1427.24 1035.49 1431.54 C 1022.09 1434.04 1009.85 1433.55 998.968 1424.13 C 993.361 1419.21 989.346 1412.74 987.435 1405.53 C 984.458 1394.29 986.554 1342.42 985.404 1325.3 C 972.138 1319.93 962.284 1316.02 950.395 1307.56 C 923.012 1288.07 903.201 1257.64 897.872 1224.34 C 892.21 1190.1 900.488 1155.02 920.859 1126.93 C 943.784 1095.82 973.572 1081.06 1010.92 1075.34 z"/></svg></h1>
  </section>

  <!-- ===== LOGIN ===== -->
  <section id="login-section" class="login-section" style="display: none;">
    <div class="login-box">
      <h2>Sign in</h2>
      <form id="login-form" autocomplete="on">
        <div class="login-field">
          <label for="login-user">Username</label>
          <input type="text" id="login-user" autocomplete="username" required>
        </div>
        <div class="login-field">
          <label for="login-pass">Password</label>
          <input type="password" id="login-pass" autocomplete="current-password" required>
        </div>
        <div id="login-error" class="login-error" style="display: none;">Invalid username or password</div>
        <button type="submit" class="login-btn">Sign in</button>
      </form>
      <div class="login-demo">
        <p class="login-demo-label">Demo accounts</p>
        <div class="login-demo-accounts">
          <button type="button" class="login-demo-account" data-user="emma" data-pass="revision">
            <strong>Emma Wilson</strong><span>emma &nbsp;/&nbsp; revision</span>
          </button>
          <button type="button" class="login-demo-account" data-user="jake" data-pass="revision">
            <strong>Jake Morris</strong><span>jake &nbsp;/&nbsp; revision</span>
          </button>
          <button type="button" class="login-demo-account" data-user="guest" data-pass="guest">
            <strong>Guest Student</strong><span>guest &nbsp;/&nbsp; guest</span>
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== SUBJECT PICKER ===== -->
  <section id="subject-picker" class="subject-picker" style="display: none;">
    <div class="picker-intro">
      <h2>Which subjects are you studying?</h2>
      <p>Select your GCSEs below. You can change these any time.</p>
    </div>
    <div id="picker-groups"></div>
    <div class="picker-footer">
      <button id="picker-continue" class="picker-continue-btn" disabled>Select at least one subject</button>
    </div>
  </section>

  <!-- ===== DASHBOARD ===== -->
  <section id="dashboard" class="dashboard" style="display: none;">
    <!-- Greeting + countdown row -->
    <div class="dashboard-greeting-row" id="dashboard-greeting-row"></div>

    <!-- Today's revision -->
    <div class="dashboard-today" id="dashboard-today"></div>

    <!-- Stats -->
    <div class="dashboard-stats" id="dashboard-stats"></div>

    <!-- Actions (change subjects, sign out) -->
    <div class="dashboard-actions" id="dashboard-actions-row">
      <button id="change-subjects" class="dashboard-action-btn">Change subjects</button>
      <button id="sign-out" class="dashboard-action-btn dashboard-signout-btn">Sign out</button>
    </div>

    <!-- Subject cards -->
    <div id="subject-grid" class="subject-grid"></div>
  </section>

  <footer style="text-align: center; padding: 2rem 1.5rem 3rem; font-size: 0.82rem; color: var(--text-muted);">
    &copy; 2026 StudyVault. Built for GCSE students.
  </footer>

  <script src="js/main.js"></script>
  <script>
  (function () {
    /* ======== Data ======== */
    var USER_KEY = 'studyvault-user';

    var demoUsers = [
      { username: 'emma', password: 'revision', name: 'Emma Wilson',
        defaults: ['history','english-lit','maths','combined-science','geography','french','fine-art'],
        examDate: '2026-05-11',
        stats: { lessons: 14, totalLessons: 60, avgScore: 78, streak: 5 },
        todayRevision: [
          { subject: 'History', lesson: 'The Abyssinia Crisis', tag: 'new', color: '#c44536', url: 'conflict-tension/lesson-09.html' },
          { subject: 'English Lit', lesson: 'An Inspector Calls: Themes', tag: 'revisit', color: '#7c3aed' },
          { subject: 'Geography', lesson: 'Urban Challenges in the UK', tag: 'new', color: '#059669' },
          { subject: 'French', lesson: 'School and Education Vocabulary', tag: 'new', color: '#1d4ed8' }
        ]
      },
      { username: 'jake', password: 'revision', name: 'Jake Morris',
        defaults: ['history','english-lang','maths','physics','computer-science','sport-science','business'],
        examDate: '2026-05-11',
        stats: { lessons: 9, totalLessons: 60, avgScore: 65, streak: 3 },
        todayRevision: [
          { subject: 'History', lesson: 'America and the Boom', tag: 'new', color: '#c44536', url: 'america/lesson-01.html' },
          { subject: 'Physics', lesson: 'Energy Stores and Transfers', tag: 'revisit', color: '#0284c7' },
          { subject: 'Computer Science', lesson: 'Binary and Data Representation', tag: 'new', color: '#4f46e5' },
          { subject: 'Maths', lesson: 'Quadratic Equations', tag: 'new', color: '#2563eb' }
        ]
      },
      { username: 'guest', password: 'guest', name: 'Guest Student', defaults: null,
        examDate: '2026-05-11', stats: null, todayRevision: null }
    ];

    var groups = [
      { label: 'Core', subjects: [
        { id: 'english-lang', name: 'English Language', board: 'AQA', image: 'images/subject-english-lang.jpg', color: '#6d28d9' },
        { id: 'english-lit', name: 'English Literature', board: 'AQA', image: 'images/subject-english-lit.jpg', color: '#7c3aed' },
        { id: 'maths', name: 'Mathematics', board: 'Pearson Edexcel', image: 'images/subject-maths.jpg', color: '#2563eb' }
      ]},
      { label: 'Sciences', subjects: [
        { id: 'combined-science', name: 'Combined Science (Trilogy)', board: 'AQA', image: 'images/subject-combined-science.jpg', color: '#0d9488' },
        { id: 'biology', name: 'Biology (Separate)', board: 'AQA', image: 'images/subject-biology.jpg', color: '#16a34a' },
        { id: 'chemistry', name: 'Chemistry (Separate)', board: 'AQA', image: 'images/subject-chemistry.jpg', color: '#ea580c' },
        { id: 'physics', name: 'Physics (Separate)', board: 'AQA', image: 'images/subject-physics.jpg', color: '#0284c7' }
      ]},
      { label: 'Languages', subjects: [
        { id: 'french', name: 'French', board: 'AQA', image: 'images/subject-french.jpg', color: '#1d4ed8' },
        { id: 'german', name: 'German', board: 'AQA', image: 'images/subject-german.jpg', color: '#ca8a04' },
        { id: 'spanish', name: 'Spanish', board: 'AQA', image: 'images/subject-spanish.jpg', color: '#dc2626' }
      ]},
      { label: 'Humanities', subjects: [
        { id: 'geography', name: 'Geography', board: 'AQA', image: 'images/subject-geography.jpg', color: '#059669' },
        { id: 'history', name: 'History', board: 'AQA', image: 'images/subject-history.jpg', color: '#c44536', active: true, url: 'home.html', detail: '4 units, 60 lessons' },
        { id: 'religious-studies', name: 'Religious Studies', board: 'AQA', image: 'images/subject-religious-studies.jpg', color: '#b45309' }
      ]},
      { label: 'Creative &amp; Practical', subjects: [
        { id: 'fine-art', name: 'Fine Art', board: 'AQA', image: 'images/subject-fine-art.jpg', color: '#db2777' },
        { id: 'textiles', name: 'Textiles', board: 'AQA', image: 'images/subject-textiles.jpg', color: '#a855f7' },
        { id: 'photography', name: 'Photography', board: 'AQA', image: 'images/subject-photography.jpg', color: '#64748b' },
        { id: 'dt', name: 'Design &amp; Technology', board: 'AQA', image: 'images/subject-dt.jpg', color: '#d97706' },
        { id: 'food', name: 'Food Preparation &amp; Nutrition', board: 'AQA', image: 'images/subject-food.jpg', color: '#b91c1c' },
        { id: 'drama', name: 'Drama', board: 'OCR', image: 'images/subject-drama.jpg', color: '#e11d48' },
        { id: 'music', name: 'Music', board: 'Eduqas (WJEC)', image: 'images/subject-music.jpg', color: '#9333ea' },
        { id: 'music-tech', name: 'Music Technology', board: 'NCFE', image: 'images/subject-music-tech.jpg', color: '#7c3aed' }
      ]},
      { label: 'Business &amp; Computing', subjects: [
        { id: 'business', name: 'Business', board: 'Pearson Edexcel', image: 'images/subject-business.jpg', color: '#475569' },
        { id: 'computer-science', name: 'Computer Science', board: 'OCR', image: 'images/subject-computer-science.jpg', color: '#4f46e5' },
        { id: 'creative-imedia', name: 'Creative iMedia', board: 'OCR', image: 'images/subject-creative-imedia.jpg', color: '#0891b2' },
        { id: 'sport-science', name: 'Sport Science', board: 'OCR', image: 'images/subject-sport-science.jpg', color: '#059669' }
      ]}
    ];

    var all = [];
    groups.forEach(function (g) { g.subjects.forEach(function (s) { all.push(s); }); });

    /* ======== DOM ======== */
    var loginEl      = document.getElementById('login-section');
    var pickerEl     = document.getElementById('subject-picker');
    var dashboardEl  = document.getElementById('dashboard');
    var loginForm    = document.getElementById('login-form');
    var loginError   = document.getElementById('login-error');
    var pickerGrid   = document.getElementById('picker-groups');
    var subjectGrid  = document.getElementById('subject-grid');
    var continueBtn  = document.getElementById('picker-continue');
    var changeBtn    = document.getElementById('change-subjects');
    var signOutBtn   = document.getElementById('sign-out');
    var greetingRow  = document.getElementById('dashboard-greeting-row');
    var todayEl      = document.getElementById('dashboard-today');
    var statsEl      = document.getElementById('dashboard-stats');

    /* ======== Auth helpers ======== */
    function getUser () {
      try { var v = localStorage.getItem(USER_KEY); return v ? JSON.parse(v) : null; } catch (e) { return null; }
    }
    function setUser (u) { localStorage.setItem(USER_KEY, JSON.stringify(u)); }
    function clearUser () { localStorage.removeItem(USER_KEY); }

    function subjectsKey () {
      var u = getUser();
      return u ? 'studyvault-subjects-' + u.username : 'studyvault-subjects';
    }
    function getSaved () {
      try { var v = localStorage.getItem(subjectsKey()); return v ? JSON.parse(v) : null; } catch (e) { return null; }
    }
    function save (ids) { localStorage.setItem(subjectsKey(), JSON.stringify(ids)); }

    function findDemoUser (username) {
      for (var i = 0; i < demoUsers.length; i++) {
        if (demoUsers[i].username === username) return demoUsers[i];
      }
      return null;
    }

    function getDemoData () {
      var u = getUser();
      if (!u) return null;
      var key = 'studyvault-demo-' + u.username;
      try { var v = localStorage.getItem(key); return v ? JSON.parse(v) : null; } catch (e) { return null; }
    }

    function saveDemoData (demo) {
      var u = getUser();
      if (!u) return;
      localStorage.setItem('studyvault-demo-' + u.username, JSON.stringify(demo));
    }

    /* ======== View switching ======== */
    function hideAll () {
      loginEl.style.display = 'none';
      pickerEl.style.display = 'none';
      dashboardEl.style.display = 'none';
    }

    function showLogin () {
      hideAll();
      loginEl.style.display = '';
      loginForm.reset();
      loginError.style.display = 'none';
    }

    function showPicker () {
      hideAll();
      pickerEl.style.display = '';
      renderPicker();
    }

    function showDashboard () {
      hideAll();
      dashboardEl.style.display = '';
      renderDashboard();
    }

    /* ======== Login ======== */
    loginForm.addEventListener('submit', function (e) {
      e.preventDefault();
      var username = document.getElementById('login-user').value.trim().toLowerCase();
      var password = document.getElementById('login-pass').value;

      var match = null;
      for (var i = 0; i < demoUsers.length; i++) {
        if (demoUsers[i].username === username && demoUsers[i].password === password) {
          match = demoUsers[i]; break;
        }
      }

      if (!match) { loginError.style.display = ''; return; }

      setUser({ username: match.username, name: match.name });

      /* Pre-populate subjects for demo users on first login */
      if (match.defaults && !getSaved()) { save(match.defaults); }

      /* Store demo dashboard data */
      if (!getDemoData() && (match.stats || match.todayRevision)) {
        saveDemoData({ stats: match.stats, todayRevision: match.todayRevision, examDate: match.examDate });
      }

      var saved = getSaved();
      if (saved && saved.length > 0) { showDashboard(); } else { showPicker(); }
    });

    /* Auto-fill demo credentials on click */
    document.querySelectorAll('.login-demo-account').forEach(function (btn) {
      btn.addEventListener('click', function () {
        document.getElementById('login-user').value = btn.dataset.user;
        document.getElementById('login-pass').value = btn.dataset.pass;
        document.getElementById('login-user').focus();
      });
    });

    signOutBtn.addEventListener('click', function () { clearUser(); showLogin(); });

    /* ======== Picker ======== */
    function renderPicker () {
      var saved = getSaved() || [];
      var set = {};
      saved.forEach(function (id) { set[id] = true; });

      var html = '';
      groups.forEach(function (g) {
        html += '<div class="picker-group"><div class="picker-group-label">' + g.label + '</div><div class="picker-group-cards">';
        g.subjects.forEach(function (s) {
          var sel = set[s.id] ? ' selected' : '';
          html += '<div class="picker-card' + sel + '" data-id="' + s.id + '" style="--picker-accent:' + s.color + '">';
          html += '<div class="picker-card-image"><img src="' + s.image + '" alt="' + s.name + '"></div>';
          html += '<span class="picker-card-name">' + s.name + '</span>';
          html += '<span class="picker-card-board">' + s.board + '</span>';
          html += '<span class="picker-card-check"></span></div>';
        });
        html += '</div></div>';
      });
      pickerGrid.innerHTML = html;
      updateBtn();
    }

    pickerGrid.addEventListener('click', function (e) {
      var card = e.target.closest('.picker-card');
      if (!card) return;
      card.classList.toggle('selected');
      updateBtn();
    });

    function updateBtn () {
      var n = pickerGrid.querySelectorAll('.picker-card.selected').length;
      continueBtn.disabled = n === 0;
      continueBtn.textContent = n === 0 ? 'Select at least one subject' : 'Continue with ' + n + ' subject' + (n !== 1 ? 's' : '');
    }

    continueBtn.addEventListener('click', function () {
      var ids = [];
      pickerGrid.querySelectorAll('.picker-card.selected').forEach(function (c) { ids.push(c.dataset.id); });
      save(ids);
      showDashboard();
    });

    /* ======== Dashboard ======== */
    function getGreeting () {
      var h = new Date().getHours();
      if (h < 12) return 'Good morning';
      if (h < 18) return 'Good afternoon';
      return 'Good evening';
    }

    function daysUntil (dateStr) {
      var target = new Date(dateStr + 'T00:00:00');
      var now = new Date();
      now.setHours(0, 0, 0, 0);
      var diff = Math.ceil((target - now) / (1000 * 60 * 60 * 24));
      return diff > 0 ? diff : 0;
    }

    function renderDashboard () {
      var u = getUser();
      var demo = getDemoData();
      var firstName = u ? u.name.split(' ')[0] : '';

      /* --- Greeting + Countdown --- */
      var gh = '<div class="dashboard-greeting">';
      gh += '<h2 class="greeting-text">' + getGreeting() + ', ' + firstName + '</h2>';
      if (demo && demo.examDate) {
        var days = daysUntil(demo.examDate);
        gh += '<span class="dashboard-countdown">' + days + ' day' + (days !== 1 ? 's' : '') + ' until your first exam</span>';
      }
      gh += '</div>';
      greetingRow.innerHTML = gh;

      /* --- Today's Revision --- */
      var th = '';
      if (demo && demo.todayRevision && demo.todayRevision.length) {
        th += '<div class="dashboard-today-inner">';
        th += '<h3 class="dashboard-section-title">Today\u2019s Revision</h3>';
        th += '<div class="today-cards">';
        demo.todayRevision.forEach(function (item) {
          var hasUrl = !!item.url;
          var tag = hasUrl ? 'a' : 'div';
          var cls = 'today-card' + (hasUrl ? '' : ' today-card--disabled');
          th += '<' + tag + (hasUrl ? ' href="' + item.url + '"' : '') + ' class="' + cls + '" style="--today-accent:' + item.color + '">';
          th += '<div class="today-card-subject">' + item.subject + '</div>';
          th += '<div class="today-card-lesson">' + item.lesson + '</div>';
          th += '<span class="today-tag today-tag--' + item.tag + '">' + (item.tag === 'new' ? 'New' : 'Revisit') + '</span>';
          th += '</' + tag + '>';
        });
        th += '</div></div>';
      } else if (u && u.username === 'guest') {
        th += '<div class="dashboard-today-inner">';
        th += '<h3 class="dashboard-section-title">Today\u2019s Revision</h3>';
        th += '<p class="dashboard-empty">Select your subjects to get started</p>';
        th += '</div>';
      }
      todayEl.innerHTML = th;

      /* --- Stats --- */
      var sh = '';
      if (demo && demo.stats) {
        var s = demo.stats;
        var pct = Math.round((s.lessons / s.totalLessons) * 100);
        var scoreClass = s.avgScore >= 70 ? 'stat-good' : (s.avgScore >= 50 ? 'stat-ok' : 'stat-low');
        sh += '<div class="dashboard-stats-inner">';
        sh += '<div class="stat-card">';
        sh += '<div class="stat-value">' + s.lessons + ' <span class="stat-total">/ ' + s.totalLessons + '</span></div>';
        sh += '<div class="stat-label">Lessons completed</div>';
        sh += '<div class="stat-bar"><div class="stat-bar-fill" style="width:' + pct + '%"></div></div>';
        sh += '</div>';
        sh += '<div class="stat-card">';
        sh += '<div class="stat-value ' + scoreClass + '">' + s.avgScore + '%</div>';
        sh += '<div class="stat-label">Avg quiz score</div>';
        sh += '</div>';
        sh += '<div class="stat-card">';
        sh += '<div class="stat-value">' + s.streak + ' days</div>';
        sh += '<div class="stat-label">Best streak</div>';
        sh += '</div>';
        sh += '</div>';
      }
      statsEl.innerHTML = sh;

      /* --- Subject Cards --- */
      var ids = getSaved() || [];
      var subjects = [];
      ids.forEach(function (id) {
        for (var i = 0; i < all.length; i++) {
          if (all[i].id === id) { subjects.push(all[i]); break; }
        }
      });

      var html = '';
      subjects.forEach(function (s) {
        var tag = s.active ? 'a' : 'div';
        var cls = 'subject-card' + (s.active ? '' : ' subject-card--coming-soon');
        html += '<' + tag + (s.active ? ' href="' + s.url + '"' : '') + ' class="' + cls + '" style="--card-accent:' + s.color + '">';
        html += '<div class="unit-card-image"><img src="' + s.image + '" alt="' + s.name + '"></div>';
        html += '<div class="unit-card-body"><h2>' + s.name + '</h2>';
        html += '<p class="unit-subtitle">' + s.board + (s.detail ? ' \u2014 ' + s.detail : '') + '</p>';
        if (s.active && demo && demo.stats) {
          var pctS = Math.round((demo.stats.lessons / demo.stats.totalLessons) * 100);
          html += '<div class="subject-progress"><div class="subject-progress-bar"><div class="subject-progress-fill" style="width:' + pctS + '%"></div></div>';
          html += '<span class="subject-progress-label">' + demo.stats.lessons + ' / ' + demo.stats.totalLessons + ' lessons</span></div>';
        }
        if (!s.active) html += '<span class="coming-soon-badge">Coming Soon</span>';
        html += '</div></' + tag + '>';
      });
      subjectGrid.innerHTML = html;
    }

    changeBtn.addEventListener('click', function () { showPicker(); });

    /* ======== Init ======== */
    var user = getUser();
    if (!user) {
      showLogin();
    } else {
      /* Ensure demo data is populated for returning users */
      if (!getDemoData()) {
        var du = findDemoUser(user.username);
        if (du && (du.stats || du.todayRevision)) {
          saveDemoData({ stats: du.stats, todayRevision: du.todayRevision, examDate: du.examDate });
        }
      }
      var saved = getSaved();
      if (saved && saved.length > 0) { showDashboard(); } else { showPicker(); }
    }
  })();
  </script>
</body>
</html>
